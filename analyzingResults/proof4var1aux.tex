\documentclass[11pt]{scrartcl}
\usepackage[sexy]{evan}
\newcommand{\vc}[1]{\boldsymbol{#1}}
\usepackage{array,multirow}


\begin{document}
\title{Proof of 4-var 1-aux Quadratisations} \date{MAY 2018}

WLOG $x \le y \le z \le w$, and  $k \ge 0$ unless otherwise stated (by flipping one bit if necessary). We would like to quadratise 
\[f = x b_1 b_2 b_3 + y b_2 b_3 b_4 + z b_3 b_4 b_1 + w b_4 b_1 b_2 + k b_1 b_2 b_3 b_4.\] We shall write $\vc b = b_1 b_2 b_3 b_4$.


{\LARGE \textbf{ List of Cases:}}
\begin{enumerate}
	\item An even number of $x, y, z, w$ lie on each side of $-\frac{k}{2}$, i.e. 
		$-\frac{k}{2} \le x \le y \le z \le w$ or $x \le y \le -\frac{k}{2} \le z \le w$ or 
		$x \le y \le z \le w \le -\frac{k}{2}$.
		Done by lemma \ref{allpositive} and flipping pairs of bits.
	\item At least three of $x, y, z, w$ lie in $(-\infty, -k] \cup [0, \infty)$. 
			By flipping bits WLOG $y, z, w \ge 0$. Summarised in proposition \ref{insidebox}.
		\begin{enumerate}
			\item $x \ge -\frac{k}{2}$. Then we are in a previous case.
			\item $-k \le x \le -\frac{k}{2}$. Done by lemma \ref{1small3large}.
			\item $x \le -k$. Done by lemma \ref{allnegative} and flipping one bit.
		\end{enumerate}
	\item An odd number of $x, y, z, w$ lie on each side of $-\frac{k}{2}$ and at least two of $x, y, z, w$ lie in $[-k, 0]$. 
		WLOG $x \le -\frac{k}{2}, y, z, w \ge -\frac{k}{2}$.
		\begin{enumerate}
			\item $-\frac{k}{2} \le y \le 0 \le z \le w$. Note that $x \ge -k$ in this cases 
				because at least two of $x, y, z, w$ lie in $[-k, 0]$.
				\begin{enumerate}
					\item $k+x+y \le 0$. Done by \ref{case4}.
					\item $k+x+y \ge 0$. Done by \ref{case3}.
				\end{enumerate}
			\item $-\frac{k}{2} \le y \le z \le 0 \le w$.
				\begin{enumerate}
					\item $x \le -k$. Done by \ref{case1}.
					\item $x \ge -k$ and $k+x+y \le 0$. Done by \ref{case4}.
					\item $x \ge -k$ and $k+x+y \ge 0$. Done by \ref{case3}.
				\end{enumerate}
			\item $-\frac{k}{2} \le y \le z \le w \le 0$.
				\begin{enumerate}
					\item $k+x+y \le 0$. Done by \ref{case2}.
					\item $k+x+y \ge 0$. Done by \ref{case6}.
				\end{enumerate}
		\end{enumerate}
\end{enumerate}



\begin{lemma}
	\label{allpositive}
	If $k \ge 0$ and $x, y, z, w \ge -\frac{k}{2}$, then $g = b_a((3k+x+y+z+w) - (2k+x+z+w)b_1 - (2k+x+y+w)b_2 - (2k+x+y+z)b_3 - (2k+y+z+w)b_4) + k(b_1b_2+b_1b_3+b_1 b_4+ b_2b_3+b_2b_4+b_3b_4) + x(b_1b_2+b_1b_3+b_2b_3) + y(b_2b_3+b_2b_4+b_3b_4) + z(b_1b_3+b_1b_4+b_3b_4) + w(b_1b_2+b_1b_4+b_2b_4)$ is a quadratisation of $f$.
\end{lemma}

\begin{proof}

Using the symmetry in the condition that $x, y, z, w$ satisfy and the symmetry in the quadratisation, WLOG consider $b_1\le b_2\le b_3\le b_4$, so we only need to check $5$ cases: $\vc b = 0000, 0001, 0011, 0111, $ or $1111$. 

If $\vc b = 0000$, then $g = b_a(3k + w + x + y + z)$. Since $k + w + x \ge 0$ and $k + y + z \ge 0$, the minimiser is $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = b_a(k + x)$. Since $k + x \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = k + y + z - b_a(k + y + z)$. Since $-(k+y + z) \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0111$, then $g = 3k + w + x + 3y + z - b_a(3k + w + x + 2y + z)$. Since $-(k+w+x) \le 0$ and $-(k+2y) \le 0$ and $-(k+z) \le 0$, $b_a^* = 1$, so $\min g = y = f$.

If $\vc b = 1111$, then $g = 6k + 3w + 3x + 3y + 3z - b_a(5k + 2w + 2x + 2y + 2z)$. Since $-k -2w \le 0$ and $-k - 2x \le 0$ and $-k -2y \le 0$ and $-k - 2z \le 0$ and $-k \le 0$, $b_a^* = 1$, so $\min g = k + w + x + y + z = f$.

\end{proof}

\begin{lemma}
	\label{allnegative}
	If $ k, x, y, z, w \le 0 $, then $g = b_a(k(b_1+b_2+b_3+b_4-3) + 
	x(b_1+b_2+b_3-2) + y(b_2+b_3+b_4-2) + z(b_3+b_4+b_1-2) + w(b_4+b_1+b_2-2))$ is a quadratisation of $f$.
\end{lemma}

\begin{remark}
	Using the standard quadratisation for the negative monomial, we can quadratise $ -b_1b_2b_3b_4 $ as $(3-b_1-b_2-b_3-b_4)b_a$, and quadratise
	$-b_1b_2b_3$ as $(2-b_1-b_2-b_3)b_a'$. Here we are saying that we can add them together and use the \textit{same} auxiliary variable.
\end{remark}

\begin{proof}
By symmetry, it suffices to check the cases when $\vc b = 0000, 0001, 0011, 0111, $ or $1111$.

If $\vc b = 0000$, then $g = -b_a(3k + 2w + 2x + 2y + 2z)$. Since $-k \ge 0$ and $-x \ge 0$ and $-y \ge 0$ and $-z \ge 0$ and $-w \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = -b_a(2k + w + 2x + y + z)$. Similar to the case when $\vc b = 0000$ we have $\min g = 0 = f$.

If $\vc b = 0011$, then $g = -b_a(k + w + x)$. Since $-k \ge 0$ and $-w \ge 0$ and $x \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0111$, then $g = b_ay$. Since $y \le 0$, $b_a^* = 1$, so $\min g = y = f$.

If $\vc b = 1111$, then $g = b_a(k + w + x + y + z)$. Since $k \le 0$ and $w \le 0$ and $x \le 0$ and $y \le 0$ and $z \le 0$, $b_a^* = 1$, so $\min g = k + w + x + y + z  = f$.

\end{proof}

This has a natural generalisation to $n$ variables.

\begin{theorem}
	Let $a_0, a_1, \cdots a_n \le 0$ and $f = a_0 \prod_{i = 1}^n b_i + \sum_{i = 1}^n \left( a_i \prod_{j \neq i} b_j\right)$ has quadratisation $g = b_a \left(a_0\left(\sum_{i=1}^n b_i - (n-1)\right) + \sum_{i=1}^n a_i \left( \sum_{j \neq i} b_j - (n-2)\right) \right) $
\end{theorem}

\begin{proof}
	Again WLOG $b_1 = b_2 = \cdots = b_k = 0$ and $b_{k+1} = b_{k+2} = \cdots = b_n = 1$ for some $k \in \{0, 1, \cdots, n\}$.
	Then \[
 f = \begin{dcases*}
        0,  & if $k \ge 2$,\\
        a_1, & if $k = 1$,\\
	\sum_{i=0}^n a_i, & if $k = 0$.
        \end{dcases*}
\]

For $k \ge 2$, we have \[
	\sum_{j\neq i } b_j \le n-2 \quad \forall j, \text{ and} \sum_{j = 1}^n b_j \le n-2,
\]
so the coefficient of $b_a$ in $g$ is non-negative, so the minimiser is $b_a^* = 0$ and $\min g = 0 = f$.

If $k = 1$, then $g = b_a a_1$, so $b_a^* = 1$ and $\min g = a_1 = f$.

If $k = 0$, then $g = b_a \sum_{i=0}^n a_i$, so $b_a^* = 1$ and $\min g = \sum_{i=0}^n a_i = f$.

\end{proof}

Next we consider some substitutions that reduce other cases to the two cases above that we know how to quadratise.

If we consider the substitution $b_1' = 1-b_1$ and $b_2' = 1-b_2$, then
\begin{align*} 
	f &= (kb_3b_4 - kb_2'b_3b_4 -kb_1'b_3b_4 + kb_1'b_2'b_3b_4) + (xb_3 - xb_1'b_3 - xb_2'b_3 +  xb_1'b_2'b_3)  \\ 
	&\phantom{=}\ + (yb_3b_4 - yb_2'b_3b_4) + (zb_3b_4 - zb_1'b_3b_4) + (wb_4 - wb_1'b_4 - wb_2'b_4 + wb_1'b_2'b_4),\end{align*}
so ignoring all linear and quadratic terms it is
\begin{align*} f' &= kb_1'b_2'b_3b_4 + xb_1'b_2'b_3 + (-y-k)b_2'b_3b_4 + (-z-k)b_3b_4b_1' + wb_4b_1'b_2'\\ 
	&=k'b_1'b_2'b_3b_4 + x'b_1'b_2'b_3 + y'b_2'b_3b_4 + z'b_3b_4b_1' + w'b_4b_1'b_2'
\end{align*}
This is of the original form with $y'=-y-k$ and $z'=-z-k$ and other coefficients unchanged. 
If we have a 1-auxiliary quadratisation for $f$ in terms of $b_1, b_2, b_3, b_4, b_a$, 
then after the substitution and taking care of the linear and quadratic terms in $f$, we obtain a 1-aux quadratisation for $f'$ in terms of $b_1', b_2', b_3, b_4, b_a$.

If $f$ has $k \ge 0$ and $w, x, y , z \ge -\frac{k}{2}$ as in \ref{allpositive}, then $f'$ has $k' \ge 0$ and $w', x' \ge -\frac{k}{2}$ and $y', w' \le -\frac{k}{2}$. And this correspondence is invertible, so given any $f'$ with  $k' \ge 0$ and $w', x' \ge -\frac{k}{2}$ and $y', w' \le -\frac{k}{2}$,
we know that it has a 1-aux quadratisation. We can also do the same substitution on the other pair of variables $b_3, b_4$ to prove that any $f''$ with $k'' \ge 0$ and $w'', x'', y'', z'' \le -\frac{k}{2}$ has a 1-aux quadratisation. 

To sum up, if $k\ge 0$, an even number of $x, y, z, w$ are at least $-\frac{k}{2}$, and an even number of them are most $-\frac{k}{2}$, then $f$ has a quadratisation in 1 auxiliary.

We can also consider substituting $b_1' = 1-b_1$ but not flipping $b_2$, then 
\[ f = k(b_2b_3b_4 - b_1'b_2b_3b_4) + x(b_2b_3 - b_1'b_2b_3) + yb_2 b_3 b_4 + z (b_3b_4 - b_3b_4b_1') + w(b_2b_4 - b_4b_1'b_2), \]
so ignoring quadratic and linear terms we are left with 
\[ f' = -k b_1'b_2b_3b_4 -xb_1'b_2b_3 + (k+y)b_2b_3b_4 -zb_3b_4b_1' -w b_4 b_1' b_2 .\]

If $k \ge 0$ and $y \le -k$ and $x, z, w \ge 0$, then $f'$ is of the form in \ref{allnegative}, so we can quadratise $f'$. Putting back in the quadratic and linear terms and substitute back, we can obtain a quadratisation of $f$.
 
By flipping another pair $b_2'=1-b_2$ and $b_3'=1-b_3$ as before, we also see that if $k \ge 0$ and three of $x, y, z, w$ are at most $ -k$ and the remaining one is at least $0$, then $f$ can be quadratised with 1 auxiliary.

Therefore, we have proved the following. 
\begin{proposition}
	\label{oldcases}
	If $k \ge 0$ and either of the following holds:
	\begin{enumerate}
		\item  $x, y, z, w \ge -\frac{k}{2}$;
		\item three of them are at least 0 and the other one is at most $-k$;
		\item two are at least $ -\frac{k}{2}$ and the other two are at most $ -\frac{k}{2}$;
		\item one is at least $0$ and the other three are at most $-k$; or
		\item $x, y, z, w \le -\frac{k}{2}$;
	\end{enumerate}
	Then $f$ has a quadratisation with 1 auxiliary.
\end{proposition}


\begin{lemma}
	\label{1small3large}
	If $k\ge 0$, $-k\le x \le -\frac{k}{2}$, and $w, y, z \ge 0$, then$g = b_a((3k+x+y+z+w) - (2k+x+z+w)b_1 - (2k+x+y+w)b_2 - (2k+x+y+z)b_3 - (2k+y+z+w)b_4) + k(b_1b_2+b_1b_3+b_1 b_4+ b_2b_3+b_2b_4+b_3b_4) + x(b_1b_2+b_1b_3+b_2b_3) + y(b_2b_3+b_2b_4+b_3b_4) + z(b_1b_3+b_1b_4+b_3b_4) + w(b_1b_2+b_1b_4+b_2b_4)$  is a quadratisation of $f$.
\end{lemma}

\begin{remark}
This is the same quadratisation as in \ref{allpositive}.
\end{remark}

\begin{proof}
	By symmetry, WLOG $b_1 \le b_2 \le b_3$ (we cannot make assumption on $b_4$ because $x$ is special among $x, y, z, w$).
If $\vc b = 0000$, then $g = b_a(3k + w + x + y + z)$. Since $k + x \ge 0 $ and $k, y, z, w \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = b_a(k + x)$. Since $k + x\ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0010$, then $g = b_a(k + w)$. Since $k, w \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = -(b_a - 1)(k + y + z)$. Since $-k \le 0$ and $-y \le 0$ and $-z \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0110$, then $g = -(b_a - 1)(k + x + y)$. Since $-(k+x) \le 0$ and $-y \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0111$, then $g = 3k + w + x + 3y + z - b_a(3k + w + x + 2y + z)$.
Since $-(k+x) \le 0$ and $-k, -w, -y, -z \le 0$, $b_a^* = 1$, so $\min g = y = f$.

If $\vc b = 1110$, then $g = 3k + w + 3x + y + z - b_a(3k + w + 2x + y + z)$.
Since $-2(k+x) \le 0$ and $-k, -w, -y, -z \le 0$, $b_a^* = 1$, so $\min g = x = f$.

If $\vc b = 1111$, then $g = 6k + 3w + 3x + 3y + 3z - b_a(5k + 2w + 2x + 2y + 2z)$.
Since $-2(k+x) \le 0$ and $-k, -w, -y, -z \le 0$, $b_a^* = 1$, so $\min g = k+ w+ x + y + z = f$.
\end{proof}

For $k \ge 0$, we have shown that $f$ has a 1-auxiliary quadratisation if  $x, y, z, w \ge -\frac{k}{2}$, 
or if $x\le -k$ and $w, y, z \ge 0$ (both cases are sumarised in \ref{oldcases}), so we can combine them 
with \ref{1small3large} (for $-k\le x \le -\frac{k}{2}$, and $w, y, z \ge 0$) to conclude:
\begin{proposition}
$f$ can be quadratised with 1 auxiliary if $k, y, z, w \ge 0$, whatever the value of $x$ is.
\end{proposition}

Recall that we can substitute $b_1'=1-b_1$ and $b_2'=1-b_2$ to transform $y$ to $ -k-y $ and $z$ to $-k-z$. This means we can flip a pair of the cubic coefficients in the range $[0, +\infty)$ to $(-\infty, -k]$ or vice versa. (e.g. since we have a quadratisation for $w \ge 0$, $y \ge 0$, $z\ge 0$,
we can find a quadratisation for $w\le -k, y \le -k, z \ge 0$) 
Or we may as well flip x and flip one other coefficient in the proposition above. Since the above proposition does not place any condition on $x$, we can e.g. go from  $w\ge 0, y\ge 0, z\ge 0$ to $w\le -k, y\ge 0, z\ge 0$. This gives the following

\begin{proposition}
	\label{insidebox}
If $k \ge 0$ and three of the cubic coefficients are in $(-\infty, -k] \cup [0, +\infty)$, then $f$ has a quadratisation with 1 auxiliary.
\end{proposition}

If some $f$ has $k \ge 0$ but is not covered by \ref{insidebox}, then at least two of the cubic coefficients are in $[-k, 0]$. 
If it is not covered by \ref{oldcases} either, then an odd number of cubic coefficients lie on each side of $-\frac{k}{2}$
(WLOG $x \le -\frac{k}{2}$ and $y, z, w \ge -\frac{k}{2}$). This is what we will break down into a further $6$ cases.

Below we assume $k \ge 0$.
\begin{table}[h!]
	\centering
	\begin{tabular}{|c|c|c|c|}
	\hline
	\multirow{2}{*}{Cases} &\multirow{2}{*}{$x \le -k$} &  \multicolumn{2}{c|}{$-k \le x \le -\frac{k}{2}$} \\\cline{3-4}
	
	& & $k + x + y \le 0$& $k + x + y \ge 0$ \\
		\hline 
		$ -\frac{k}{2} \le y \le 0 \le z \le w$ & \ref{insidebox}: only $y \in [-k,0]$ &  \multirow{2}{*}{\ref{case4}} & 
		 \multirow{2}{*}{\ref{case3}}\\\cline{1-2}
		$ -\frac{k}{2} \le y \le z \le 0 \le w$ &  \ref{case1}& &  \\
		\hline 
		$ -\frac{k}{2} \le y \le z \le w \le 0$ & \multicolumn{2}{c|}{\ref{case2}}  & \ref{case6} \\
		\hline
	\end{tabular}
\end{table}

\begin{lemma}
	\label{case1}
	If $x\le -k$ and $-\frac{k}{2} \le y \le z \le 0 \le w$, then 
	$g = b_a(x(b_1-b_2-b_3)+y(-b_2-b_3+b_4)+z(1-b_1+b_3-b_4)+w(1-b_1+b_2-b_4)+k(1-b_1-b_4))
+x(-b_1+b_1 b_2+b_1 b_3)+y(-b_4+b_2 b_4+b_3 b_4)+z b_1 b_4 +w b_1 b_4 +k b_1 b_4 $ is a quadratisation of $f$.

\end{lemma}
\begin{proof}
If $\vc b = 0000$, then $g = b_a(k + w + z)$. Since $w \ge 0$ and $k + z \ge 0$, the minimiser is $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = b_ay - y$. Since $y \le 0$, $b_a^*= 1$, so $\min g = 0 = f$.

If $\vc b = 0010$, then $g = b_a(k + w - x - y + 2z)$. Since $k + 2z \ge 0$ and $ w \ge 0 $ and $- x\ge 0$ and $-y \ge 0$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = b_a(z - x)$. Since $z \ge x$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0100$, then $g = b_a(k + 2w - x - y + z)$. Since $k +2z \ge 0$ and $w \ge 0$ and $-x \ge 0 $ and $-y \ge 0$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0101$, then $g = b_a(w - x)$. Since $w \ge x$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0110$, then $g = b_a(k + 2w - 2x - 2y + 2z)$. Since $k + 2z \ge 0$ and $w \ge 0$ and $-x \ge 0$ and $-y \ge 0$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 0111$, then $g = y + b_a(w - 2x - y + z)$. Since $w \ge 0$ and $z - y \ge 0$ and $-x \ge 0$, $b_a^*= 0$, so $\min g = y = f$.

If $\vc b = 1000$, then $g = b_ax - x$. Since $x \le 0$, $b_a^*= 1$, so $\min g = 0 = f$.

If $\vc b = 1001$, then $g = k + w - x - y + z +b_a(-k - w + x + y - z)$. Since $-k \le 0 $ and $-w \le 0 $ and $y \le z$ and $-x \le 0$, $b_a^*= 1$, so $\min g = 0 = f$.

If $\vc b = 1010$, then $g = b_a(z - y)$. Since $ z \ge y$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 1011$, then $g = k + w + z + b_a(-k - w)$. Since $- k \le 0$ and $-w \le 0$, $b_a^*= 1$, so $\min g = z = f$.

If $\vc b = 1100$, then $g = b_a(w - y)$. Since $w \ge y$, $b_a^*= 0$, so $\min g = 0 = f$.

If $\vc b = 1101$, then $g = k + w + z - b_a(k + z)$. Since $-(k + z) \le 0$, $b_a^*= 1$, so $\min g = w = f$.

If $\vc b = 1110$, then $g = x + b_a(w - x - 2y + z)$. Since $w + z \ge 0$ and $-x \ge 0$ and $-y \ge 0$, $b_a^* = 0$, so $\min g = x = f$.

If $\vc b = 1111$, then $g = k + w + x + y + z - b_a(k + x + y)$. Since $-(k + x) \ge 0$ and $-y \ge 0$, $b_a^*= 0$, so $\min g = k+w+x+y+z = f$.

\end{proof}

\begin{lemma}
	\label{case3}
	If $-k\le x \le -\frac{k}{2} \le y \le 0  \le w $, $y \le z \le w$, and $k + x + y \ge 0$, then $g = b_a(x(-1+b_1+b_2+b_3)+y(-1+b_2+b_3+b_4)+z(-1+b_1+b_3+b_4)+w(-1+b_1+b_2+b_4)+k(-3+2b_1+2b_2+2b_3+2b_4))+x(+1 -b_1-b_2-b_3+b_1b_2+b_1b_3+b_2b_3)+y(+1 -b_2-b_3-b_4+b_2b_3+b_2b_4+b_3b_4)+z(+1 -b_1-b_3-b_4+b_1b_3+b_1b_4+b_3b_4)+w(+1 -b_1-b_2-b_4+b_1b_2+b_1b_4+b_2b_4)+k(+3 -2 b_1-2 b_2-2 b_3-2 b_4+b_1b_2+b_1b_3+b_1b_4+b_2b_3+b_2b_4+b_3b_4)$ 
	is a quadratisation of $f$.
 \end{lemma}

\begin{proof}
	If $\vc b = 0000$, then $g = 3k + w + x + y + z - b_a(3k + w + x + y + z)$. Since $-x - k \le 0$ and $ -\frac{k}{2} - y \le 0$ and $-\frac{k}{2} - z \le 0$ 
and $-k \le 0$ and $-w \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = k + x - b_a(k + x)$. 
Since $-k -x \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0010$, then $g = k + w - b_a(k + w)$.
Since $-k \le 0$ and $-w \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = b_a(k + y + z)$.
Since $k + y + z \ge k + 2y \ge 0 $, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0100$, then $g = k + z - b_a(k + z)$.
Since $-k - z \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0101$, then $g = b_a(k + w + y)$.
Since $k + y \ge 0 $ and $w \ge 0$, $b_a^* = 0 $, so $\min g = 0 = f$.

If $\vc b = 0110$, then $g = b_a(k + x + y)$. Since $k + x + y \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0111$, then $g = y + b_a(3k + w + x + 2y + z)$. Since $k + x \ge 0$ and $k + 2y \ge 0$ and $k + z\ge 0 $ and $w  \ge 0$, 
$b_a^* = 0$, so $\min g = y = f$.

If $\vc b = 1000$, then $g = k + y - b_a(k + y)$. Since $-k - y \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1001$, then $g = b_a(k + w + z)$.
Since $k + z \ge 0$ and $w \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1010$, then $g = b_a(k + x + z)$.
Since $k + x + z \ge k + x + y \ge 0 $, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1011$, then $g = z + b_a(3k + w + x + y + 2z)$.
Since $k + x \ge 0$ and $k + y \ge 0$ and $k + 2z \ge 0 $ and $w \ge 0 $, $b_a^* = 0$, so $\min g = z = f$.

If $\vc b = 1100$, then $g = b_a(k + w + x)$.
Since $k + x \ge 0$ and $w \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1101$, then $g = w + b_a(3k + 2w + x + y + z)$.
Since $k + x \ge 0 $ and $k + y \ge 0 $ and $k + z \ge 0 $ and $w  \ge 0$, $b_a^* = 0$, so $\min g = w = f$.

If $\vc b = 1110$, then $g = x + b_a(3k + w + 2x + y + z)$.
Since $2k + 2x \ge 0$ and $k + y + z \ge 0$ and $w \ge 0$, $b_a^* = 0$, so $\min g = x = f$.

If $\vc b = 1111$, then $g = k + w + x + y + z + b_a(5k + 2w + 2x + 2y + 2z)$.
Since $2k + 2x \ge 0$ and $2k + 2y + 2z\ge 0$ and $k \ge 0$ and $w  \ge 0$, $b_a^* = 0$, so $\min g = k + w + x + y + z = f$.

\end{proof}

\begin{lemma}
	\label{case4}
	If $-k\le x \le -\frac{k}{2} \le y \le 0 \le w$ and $y \le z \le w$ and $k+x+y \le 0$, then $g = b_a(x(+b_1-b_2-b_3)+y(-b_2-b_3+b_4)+z(1-b_1+b_3-b_4)+w(1-b_1+b_2-b_4)+k(1-b_1-b_4))+x(-b_1+b_1b_2+b_1b_3)+y(-b_4+b_2b_4+b_3b_4)+z(+b_1b_4)+w(+b_1b_4)+k(+b_1b_4)$ is a quadratisation of $f$.
 \end{lemma}

\begin{proof}
If $\vc b = 0000$, then $g = b_a(k + w + z)$.
Since $k + z \ge 0 $ and $w \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = b_ay - y$.
Since $y \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0010$, then $g = b_a(k + w - x - y + 2z)$.
Since $w \ge 0 $ and $k + 2z \ge 0$ and $-x \ge 0$ and $-y \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = b_a(z - x)$.
Since $z \ge x$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0100$, then $g = b_a(k + 2w - x - y + z)$.
Since $k + z \ge 0$ and $w \ge 0$ and $-x \ge 0$ and $-y \ge 0$, $b_a^* = 0 $, so $\min g = 0 = f$.

If $\vc b = 0101$, then $g = b_a(w - x)$.
Since $w \ge x$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0110$, then $g = b_a(k + 2w - 2x - 2y + 2z)$.
For the same reason as with $\vc b = 0010$, $\min g = 0 = f$.

If $\vc b = 0111$, then $g = y + b_a(w - 2x - y + z)$.
Since $w \ge 0$ and $z-y \ge 0$ and $-x \ge 0$, $b_a^* = 0$, so $\min g = y = f$.

If $\vc b = 1000$, then $g = b_ax - x$.
Since $x \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1001$, then $g = k + w - x - y + z - b_a(k + w - x - y + z)$.
Since $-k - z \le 0$ and $-w \le 0$ and $-x \le 0 $ and $-y \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1010$, then $g = b_a(z - y)$.
Since $z \ge y$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1011$, then $g = k + w + z - b_a(k + w)$.
Since $-k \le 0$ and $-w \le 0$, $b_a^* = 1$, so $\min g = z = f$.

If $\vc b = 1100$, then $g = b_a(w - y)$.
Since $w \ge y$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1101$, then $g = k + w + z - b_a(k + z)$.
Since $-k - z \le 0$, $b_a^* = 1$, so $\min g = w = f$.

If $\vc b = 1110$, then $g = x + b_a(w - x - 2y + z)$.
Since $w \ge 0$ and $z - y \ge 0$ and $-y \ge 0$ and $-x \ge 0$, $b_a^* = 0$, so $\min g = x = f$.

If $\vc b = 1111$, then $g = k + w + x + y + z - b_a(k + x + y)$.
Since $-(k + x + y) \ge 0$, $b_a^* = 0$, so $\min g = k + w + x + y + z = f$. 

\end{proof}

\begin{lemma}
	\label{case6}
	If $-k\le x \le -\frac{k}{2} \le y \le z \le w \le 0$ and $k+x+y \ge 0$, then $g = b_a(x(1-b_1-b_2-b_3)+y(1-b_2-b_3-b_4)+z(1-b_1-b_3-b_4)+w(1-b_1-b_2-b_4)+k(3-2b_1-2b_2-2b_3-2b_4))+x(+b_1b_2+b_1b_3+b_2b_3)+y(+b_2b_3+b_2b_4+b_3b_4)+z(+b_1b_3+b_1b_4+b_3b_4)+w(+b_1b_2+b_1b_4+b_2b_4)+k(+b_1b_2+b_1b_3+b_1b_4+b_2b_3+b_2b_4+b_3b_4)$ is a quadratisation of $f$.
 \end{lemma}

\begin{proof}
If $\vc b = 0000$, then $g = b_a(3k + w + x + y + z)$.
Since $k+x \ge 0 $ and $2k + w + y + z \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = b_a(k + x)$.
Since $k+x \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0010$, then $g = b_a(k + w)$.
Since $k+w \ge 0$, $b_a^* = 0 $, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = k + y + z - b_a(k + y + z)$.
Since $-\frac{k}{2} - y \le 0$ and $-\frac{k}{2} - z \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0100$, then $g = b_a(k + z)$.
Since $k + z \ge 0 $, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 0101$, then $g = k + w + y - b_a(k + w + y)$.
Since $- \frac{k}{2} - w \le 0$ and $- \frac{k}{2} - y \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0110$, then $g = k + x + y - b_a(k + x + y)$.
Since $-(k+x+y) \le 0$, $b_a^* = 1$, so $\min g = 0 = f$. 

If $\vc b = 0111$, then $g = 3k + w + x + 3y + z - b_a(3k + w + x + 2y + z)$.
Since $-k - x \le 0$ and $-k - 2y \le 0$ and $-k - w - z \le 0$, $b_a^* = 1$, so $\min g = y = f$.

If $\vc b = 1000$, then $g = b_a(k + y)$.
Since $k + y \ge 0$, $b_a^* = 0 $, so $\min g = 0 = f$.

If $\vc b = 1001$, then $g = k + w + z - b_a(k + w + z)$.
Since $-k - w - z \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1010$, then $g = k + x + z - b_a(k + x + z)$.
Since $-(k+x+z) \le -(k+x+y) \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1011$, then $g = 3k + w + x + y + 3z - b_a(3k + w + x + y + 2z)$.
Since $-k - x\le 0 $ and $-k - w - y \le 0$ and $-k - 2z \le 0$, $b_a^* = 1$, so $\min g = z = f$.  

If $\vc b = 1100$, then $g = k + w + x - b_a(k + w + x)$.
Since $-(k+w+x) \le -(k+x+y) \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1101$, then $g = 3k + 3w + x + y + z - b_a(3k + 2w + x + y + z)$.
Since $-k -2w \le 0$ and $-k - x \le 0$ and $-k -y - z \le 0$, $b_a^* = 1$, so $\min g = w = f$.

If $\vc b = 1110$, then $g = 3k + w + 3x + y + z - b_a(3k + w + 2x + y + z)$.
Sincde $-(k+x+y) \le 0$ and $-k - x \le 0$ and $-k - w - z \le 0$, $b_a^* = 1$, so $\min g = x = f$.

If $\vc b = 1111$, then $g = 6k + 3w + 3x + 3y + 3z - b_a(5k + 2w + 2x + 2y + 2z)$.
Since $-2k - 2x \le 0$ and $-k - 2y \le 0$ and $-k -2z \le 0$ and $-k -2w \le 0$, $b_a^* = 1$, so $\min g = k + w + x + y + z = f$.

\end{proof}

\begin{lemma}
	\label{case2}
 If $x \le -\frac{k}{2} \le y \le z \le w \le 0$ and $k+x+y \le 0$, then $g = b_a(x(-b_1+b_2+b_3)+y(+b_2+b_3-b_4)+z(-1+b_1-b_3+b_4)+w(-1+b_1-b_2+b_4)+k(-1+b_1+b_4))+x(-b_2-b_3+b_1b_2+b_1b_3)+y(-b_2-b_3+b_2b_4+b_3b_4)+z(+1 -b_1+b_3-b_4+b_1b_4)+w(+1 -b_1+b_2-b_4+b_1b_4)+k(+1 -b_1-b_4+b_1b_4)$ is a quadratisation of $f$.
 \end{lemma}

\begin{proof}
If $\vc b = 0000$, then $g = k + w + z - b_a(k + w + z)$.
Since $-k - w - z \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0001$, then $g = -b_ay$.
Since $-y \ge 0$, $b_a^* = 0 $, so $\min g = 0 = f$.

If $\vc b = 0010$, then $g = k + w - x - y + 2z + b_a(-k - w + x + y - 2z)$.
Since $-k - 2z \le 0$ and $x \le w$ and $ y \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0011$, then $g = z - x + b_a(x - z)$.
Since $x \le z$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0100$, then $g = k + 2w - x - y + z + b_a(-k - 2w + x + y - z)$.
Since $-k - 2w \le 0$ and $y \le z$ and $x \le 0$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0101$, then $g = w - x + b_a(x - w)$.
Since $x \le w$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0110$, then $g = k + 2w - 2x - 2y + 2z + b_a(-k -2w + 2x + 2y - 2z)$.
Since $-k \le 0$ and $x \le z$ and $y \le w$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 0111$, then $g = w - 2x + z + b_a(-w + 2x + y - z)$.
Since $x \le w$ and $y \le z$ and $x \le 0$, $b_a^* = 1$, so $\min g = y = f$.

If $\vc b = 1000$, then $g = -b_ax$.
Since $-x \ge 0$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1001$, then $g = b_a(k + w - x - y + z)$.
Since $k \ge 0$ and $w \ge x $ and $z \ge y$, $b_a^* = 0$, so $\min g = 0 = f$.

If $\vc b = 1010$, then $g = z - y + b_a(y - z)$.
Since $y \le z$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1011$, then $g = z + b_a(k + w)$.
Since $k + w \ge 0$, $b_a^* = 0$, so $\min g = z = f$.

If $\vc b = 1100$, then $g = w - y + b_a(y -w)$.
Since $y \le w$, $b_a^* = 1$, so $\min g = 0 = f$.

If $\vc b = 1101$, then $g = w + b_a(k + z)$.
Since $k+z \ge 0$, $b_a^* = 0 $, so $\min g = w = f$.

If $\vc b = 1110$, then $g = w - 2y + z + b_a(-w + x + 2y - z)$.
Since $x \le w$ and $ y \le z$ and $y \le 0$, $b_a^* = 1$, so $\min g = x =f $.

If $\vc b = 1111$, then $g = w + z + b_a(k + x + y)$.
Since $k+x + y \le 0$, $b_a^* = 1$, so $\min g = k + w + x + y + z = f$.
\end{proof}


Hence we have shown that every $f$ with $k\ge 0$ has a quadratisation with 1 auxiliary. Using the substitution $b_1'=1-b_1$,
we can go between cases with $k \ge 0$ and $k \le 0$, so all 4-variable pseudo-boolean functions has a quadratisation with 1 auxiliary.

\begin{theorem}[A sufficient condition for existence of 1-aux quadratisation]
Let $f = f(\vc b)$ be fully symmetric in the $n$ bits $b_1, \cdots, b_n$. Write $|\vc b|=\sum b_i$ and $h(|b|) = f(\vc b)$. (Note that $h$ 
is well-defined because $f$ is symmetric. Suppose $h(0), \cdots, h(n)$ is an arithmetic progression but with all positive terms replaced by 0, 
i.e. $h(i) = (ai+d)^- = \min(ai+d, 0)$ for some constant $a, d$, then $f$ is quadratisable with one auxiliary.  
\end{theorem}

\begin{proof}
	In fact we have a quadratisation that is also symmetric in $b_1, \cdots, b_n$.
	Let $g = b_a(a|\vc b| + d) = b_a (a(\sum b_i) + d)$. This is quadratic in $\bc b, b_a$ and 
	\[\min_{b_a} g = f \quad \forall \vc b \in \{0, 1\}^n\]
	using the property of $f$.
\end{proof}

\end{document}
